<script>
if (PH.state.wallets.length === 0) {
  addWallet = function(event) {
    document.getElementById('alert-area').style.display = 'none';

    try {
      var walletPrivKey = document.getElementById('wallet_priv_key').value;
      var friendlyName = document.getElementById('friendly_name').value;

      var wallet = Neon.create.account(walletPrivKey);

      var data = {
                   name: friendlyName || 'My first wallet',
                   address: wallet.getPublicKey(),
                   privateKey: walletPrivKey
                 };

      PH.neoWallet = wallet;
      PH.state.wallets.push(data);
      PH.state.mainWallet = PH.state.wallets.length - 1;

      window.render();
      $("#firstWallet").modal('hide');

      PH.contract.registerMailbox(friendlyName);
    } catch (e) {
      document.getElementById('alert-area').style.display = 'block';
    }
  }
}
</script>

<div class="modal fade" id="firstWallet" tabindex="-1" role="dialog" aria-labelledby="firstWalletLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="firstWalletLabel">First Phantasma wallet</h5>

        <div class="alert alert-danger" role="alert" id="alert-area" style="display: none">
          The wallet check failed. Please check your address and try again.
        </div>
      </div>

      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="wallet_priv_key" class="control-label">Private key (hex-format, 64 characters)</label>
            <input type="password" required class="form-control select2-offscreen" id="wallet_priv_key" name="wallet_priv_key" placeholder="Private key" autocomplete="off" />
          </div>

          <div class="form-group">
            <label for="friendly_name" class="control-label">Friendly name (optional)</label>
            <input type="text" class="form-control" id="friendly_name" name="friendly_name" placeholder="My first wallet" autocomplete="off" />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" onclick="addWallet(event)" class="btn pretty-btn">Add</button>
      </div>
    </div>
  </div>
</div>

<script>
PH.afterLoad(function() {
  document.getElementById('alert-area').style.display = 'none';

  if (PH.state.wallets.length === 0) {
      $('#firstWallet').modal({ backdrop: 'static', keyboard: false });
  }
});
</script>